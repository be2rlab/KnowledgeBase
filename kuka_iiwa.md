# !!! Важно перед использованием !!!

Безопасность прежде всего! 

1. Перед использованием алгоритмов проверьте их в симуляции и только потом пробуйте на реальном роботе
2. Не запускайте робота, если человек находится в рабочей области робота
3. Для тестов алгоритмов запускайте робота в безопасном режиме T1 с ограничениями по скорости и положению
4. При запуске новых алгоритмов держите руку на красной кнопки на паде, чтобы успеть незамедлительно нажать на нее, если что-то пойдет не так!

# Обшая информация 

Управление iiwa имеет три режима: T1, T2, AUT. Первый два режима являются безопасными с ограничениями по скорости и блокировкой осей. В T1 более жесткие ограничения, чем у T2. Последний AUT не имеет ограничения и предназначен для управления через комп. 

Чтобы снять режим блокировки в режиме T1, T2 нужно зажать белые триггеры или кнопку на задней панели пульта.

Перключение режимов выполняет через свитч на паде рядом с аварийной кнопкой

# Подключение гриппера 

Управление и питание гриппера можно прокинуть через систему iiwa: На EE есть 3 пиновый порт для питания и 8 пиновый, цифровой. Тогда будет необходить настроить пины на контроллере (скорее всего муторно и не интересно). Или пробросить отдельный кабель напрямую к компу чепез драйвер, что будет проще сделать. 

В контроллер  iiwa витая пара, можно подключать через нее. 

## Windows 

На винде есть sdk для менеджменету проекта на контроллере. Для добавления новых драйверов пакеты нужно будет добавлять в пакет и синхронизировать с iiwa. **!!НЕ ЗАБЫВАТЬ ДЕЛАТЬ БЭКАПЫ!!** перед тем как что-то менять. Вторая программа (синяя) для настройки портов. 

# iiwa_stack:ROS + MoveIt

На Ubuntu 16.04 есть инстнрукция по запуску moveit через ros.

1. Включить iiwa
2. Подключить через Ethernet порт X66 и сетевую карту на компе
3. Включить комп
4. Перевести iiwa в авторматический режим 
5. Запустить RosSmartServo
6. Запустить roslaunch moveit ... на компе 

# Drake 

Драйвер дрейка доступен на ядре Ubuntu 20.04

# Настройка пакетов ROS2

Проверено на ROS2 Humble на Ubuntu 22.04

1. Поставить [ROS2 Humble](https://docs.ros.org/en/humble/Installation.html) на рабочем ПК
2. Загрузить драйвер iiwa под ROS2: [lbr_fri_ros2_stack](https://github.com/lbr-stack/lbr_fri_ros2_stack/tree/humble)
3. Настроить контроллер на реальном роботе по [инструкции](https://lbr-stack.readthedocs.io/en/latest/lbr_fri_ros2_stack/lbr_fri_ros2_stack/doc/hardware_setup.html) через Windows на ПК за столом 14
4. Настроить сеть на рабочем ПК:
    - `Settings -> Network -> Wired`; Выбрать порт через которые будет общение с iiwa и зайти в его настройки
    - `Identity` - не трогаем! `IPv6` - Disabled; `Security` - Off
    - `IPv4` - Manual: Address: `192.170.10.1`; Netmask: `255.255.255.0`. Остальные настройки можно не трограть
5. Проверить среду с помощью примеров на [вики драйвера](https://lbr-stack.readthedocs.io/en/latest/lbr_fri_ros2_stack/lbr_demos/lbr_demos_py/doc/lbr_demos_py.html)
